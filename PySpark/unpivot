from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("UnpivotExample").getOrCreate()

data = [("Laptop", 100, 120, 130, 110),
        ("Phone", 90, 95, 100, 105)]
columns = ["product", "Q1", "Q2", "Q3", "Q4"]

df = spark.createDataFrame(data, columns)

# Apply unpivot using stack()
unpivoted_df = df.selectExpr("product",
    "stack(4, 'Q1', Q1, 'Q2', Q2, 'Q3', Q3, 'Q4', Q4) as (quarter, sales)")

unpivoted_df.show()